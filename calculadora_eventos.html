<!doctype html>
  <html>
    <head>
      <meta charset="utf-8">
      <title>Web Calculator</title>
      <link rel="stylesheet" href="css/cssCalculadora.css" type="text/css">
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
      <script>
        $(document).ready(function(){
          $("#display").val("0");
         // document.getElementById("")
        })
        var cifra ="";
        var cont = 0;
        var ultValor = 0;
        var ultOperando="";
        var resultado ="";
        
        
        function displayNumbers(num){
           cifra =  cifra + num;
           $("#display").val(cifra);
        }
          //hay que indicar el valor de cifra al final por que no lo lee junto al vaor dado en ultOperando
        function reset(){
          $("#display").val("0")
          cont=0,ultValor=0;
          cifra="",ultOperando = "";
        }

        /*el uso de la recursividad en cada uno de los casos permite concatenar operaciones en la calculadora haciendo que en caso de ocurrir
          la ultima de ellas se vaya realizando sin  dar al simbolo "=", por eso en los case / o *, hubo que realizar a la vuelta  de la 
          recursividad dividir entre 1 o multiplicar por 1,respectivamente,  ya que si no sobresecribia el resultado de la anterior operación 
          con el campo cifra en blanco dando errores en el resultado de la operación previa*/
        function operacion(op){
          switch(op){
            case '+':
            if(ultOperando=="-"||ultOperando=="*"||ultOperando=="/")operacion(ultOperando);
              ultValor += Number(cifra);
              $("#display").val(ultValor);
                
              cifra = "";
              cont++;
              ultOperando = op;
              break;
            case '-':
            if(ultValor==0 && cont==0){
                ultValor= Number(cifra);
              }
            else{
              if(ultOperando=="+"||ultOperando=="*"||ultOperando=="/")operacion(ultOperando);
              ultValor -= Number(cifra);
            }
              $("#display").val(ultValor);
                
              cifra = "";
              cont++;
              ultOperando = op;
              break;
            case '*':
            if(ultValor==0 && cont==0){
                ultValor= Number(cifra);
              }else{
                if(ultOperando=="+"||ultOperando=="-"||ultOperando=="/"){
                  operacion(ultOperando);
                  ultValor*=1;
                }else{
                  ultValor *= Number(cifra);
                }
              }

             $("#display").val(ultValor);

              cifra = "";
              cont++;
              ultOperando = op;
              break;

            case '/':
              if(ultValor==0 && cont==0){
                ultValor= Number(cifra);
              }else{
                if(ultOperando=="+"||ultOperando=="*"||ultOperando=="-"){
                  operacion(ultOperando);
                ultValor /= 1;
              }else{
                ultValor /= Number(cifra);
              }
              }
              
              $("#display").val(ultValor);

              cifra = "";
              cont++;
              ultOperando = op;
              break;
          }
        }
        function igual(){
           switch(ultOperando){
              case "+": 
              resultado = ultValor+=Number(cifra)
                $("#display").val(resultado);
                cifra= resultado;
                ultValor=0;
                cont=0;
                break;
              case '-':
              resultado = ultValor-=Number(cifra)
                $("#display").val(resultado);
                cifra= resultado;
                ultValor=0;
                cont=0;
                break;
              case '*':
              resultado = ultValor*=Number(cifra)
                $("#display").val(resultado);
                cifra= resultado;
                ultValor=0;
                cont=0;
                break;
              case '/':
                resultado = ultValor/=Number(cifra)
                $("#display").val(resultado);
                cifra= resultado;
                ultValor=0;
                cont=0;
                break;
            }
        }

      </script>

   
    </head>

    <body>
      <table>
        <tr>
          <td colspan="4">
            <input name="display" type="text" class="color_display" id="display" size="25">
          </td>
        </tr>
        <tr>
          <td width="26%"><input name="button" type="button" class="numero" id="button" value="+" onclick="operacion(this.value)"></td>
          <td width="21%"><input name="button2" type="button" class="numero" id="button2" value="-" onclick="operacion('-')"></td>
          <td width="21%"><input name="button3" type="button" class="numero" id="button3" value="*" onclick="operacion('*')"></td>
          <td width="32%"><input name="button4" type="button" class="numero" id="button4" value="/" onclick="operacion('/')"></td>
        </tr>
        <tr>
          <td><input name="num7" type="button" class="numero" id="num7" value="7" onclick="displayNumbers(7)" ></td>
          <td><input name="num8" type="button" class="numero" id="num8" value="8" onclick="displayNumbers(8)"></td>
          <td><input name="num9" type="button" class="numero" id="num9" value="9" onclick="displayNumbers(9)"></td>
          <td><input name="reset" type="button" class="numero" id="reset" value="C" onclick="reset()"></td>
        </tr>
        <tr>
          <td><input name="num4" type="button" class="numero" id="num4" value="4" onclick="displayNumbers(4)"></td>
          <td><input name="num5" type="button" class="numero" id="num5" value="5" onclick="displayNumbers(5)"></td>
          <td><input name="num6" type="button" class="numero" id="num6" value="6" onclick="displayNumbers(6)"></td>
          <td>&nbsp;</td>
        </tr>
        <tr>
          <td><input name="num1" type="button" class="numero" id="num1" value="1" onclick="displayNumbers(1)"></td>
          <td><input name="num2" type="button" class="numero" id="num2" value="2" onclick="displayNumbers(2)"></td>
          <td><input name="num3" type="button" class="numero" id="num3" value="3" onclick="displayNumbers(3)"></td>
          <td>&nbsp;</td>
        </tr>
        <tr>
          <td><input name="num0" type="button" class="numero" id="num0" value="0" onclick="displayNumbers(0)"></td>
          <td><input name="button17" type="button" class="numero" id="button17" value="," onclick="displayNumbers('.')"></td>
          <td colspan="2"><input name="button12" type="button" class="igual" id="button12" value="=" onclick="igual()"></td>
        </tr>
      </table>
    </body>
  </html>
